### 1.查看所有运行时的流程（分页）

GET   task/listRuntimeTask

入参

~~~
processDefinitionKey（流程标识）     processDefinitionName（流程定义名称）    taskName（任务名称）
~~~

 出参：

| 字段名                   | 名称                     |
| :----------------------- | ------------------------ |
| businessKey              | 流程实例主表业务数据主键 |
| entryId                  | 流程Id                   |
| processDefinitionId      | 流程定义Id               |
| processDefinitionKey     | 流程定义标识             |
| processDefinitionName    | 流程定义名称             |
| processDefinitionVersion | 流程定义版本             |
| processInstanceId        | 流程实例Id（流水号）     |
| processInstanceInitiator | 流程实例发起人           |
| processInstanceStartTime | 流程实例创建时间         |
| taskFormKey              | 任务的表单信息           |
| taskId                   | 流程任务Id               |
| taskKey                  | 流程任务标识             |
| taskName                 | 流程任务名称             |

示例：

~~~java
{
	"data":{
		"dataList":[{
			"businessKey":"1476751964434862080",
			"entryId":1450710743367290880,
			"processDefinitionId":"flowSubmit:4:87e59faf-69e6-11ec-bb85-0235bf949cb9",
			"processDefinitionKey":"flowSubmit",
			"processDefinitionName":"报销申请",
			"processDefinitionVersion":4,
			"processInstanceId":"dc101a4d-69e6-11ec-bb85-0235bf949cb9",
			"processInstanceInitiator":"admin",
			"processInstanceStartTime":"2021-12-31 11:07:59",
			"taskFormKey":"{\"formId\":\"1440947675041107968\",\"groupType\":\"DEPT_POST_LEADER\"}",
			"taskId":"dc14fc67-69e6-11ec-bb85-0235bf949cb9",
			"taskKey":"Activity_04scn2o",
			"taskName":"部门领导审批"
		}],
		"totalCount":1
	},
	"errorCode":"NO-ERROR",
	"errorMessage":"NO-MESSAGE",
	"success":true
}
~~~

### 2. 查看已办任务（分页）

GET   task/listHistoricTask

入参

~~~
processDefinitionKey（流程标识）     processDefinitionName（流程定义名称）    taskName（任务名称） taskStatus（任务状态）
~~~

 出参：

| 字段名                | 名称                             |
| :-------------------- | -------------------------------- |
| executionId           | 执行ID                           |
| id                    | 任务ID                           |
| name                  | 任务名称                         |
| assignee              | 处理人                           |
| taskDefinitionKey     | 任务定义标识                     |
| formKey               | 任务的表单信息                   |
| businessKey           | 流程实例主表业务数据主键         |
| processDefinitionId   | 流程定义Id                       |
| processDefinitionKey  | 流程定义标识                     |
| startTime             | 开始时间                         |
| endTime               | 结束时间                         |
| processDefinitionKey  | 流程定义标识                     |
| processDefinitionName | 流程定义名称                     |
| startUser             | 流程发起人                       |
| approvalType          | 批准类型                         |
| taskStatus            | 任务状态（0：审批中，1：已完成） |

示例：

~~~java
{
	"data":{
		"dataList":[{
			"executionId":"dc101a55-69e6-11ec-bb85-0235bf949cb9",
			"name":"部门领导审批",
			"assignee":"admin1",
			"taskDefinitionKey":"Activity_04scn2o",
			"formKey":"{\"formId\":\"1440947675041107968\",\"groupType\":\"DEPT_POST_LEADER\"}",
			"businessKey":"1476751964434862080",
			"processInstanceId":"dc101a4d-69e6-11ec-bb85-0235bf949cb9",
			"processDefinitionId":"flowSubmit:4:87e59faf-69e6-11ec-bb85-0235bf949cb9",
			"startTime":"2021-12-31 11:07:59",
			"endTime":"2022-01-10 10:45:35",
			"id":"dc14fc67-69e6-11ec-bb85-0235bf949cb9",
			"processDefinitionKey":"flowSubmit",
			"processDefinitionName":"报销申请",
			"startUser":"admin",
			"approvalType":"agree",
            "taskStatus":"0"
		}],
		"totalCount":1
	},
	"errorCode":"NO-ERROR",
	"errorMessage":"NO-MESSAGE",
	"success":true
}
~~~

### 3. 提交任务

post  task/submitTask

入参

| 字段名             | 名称                       |
| ------------------ | -------------------------- |
| taskId             | 流程任务Id                 |
| processInstanceId  | 流程实例Id                 |
| taskVariableData   | 流程任务变量数据           |
| masterData         | 流程审批相关的主表数据     |
| flowTaskCommentDto | 流程审批数据               |
| slaveData          | 流程审批相关的多个从表数据 |



~~~
{
	"taskId": "f07c6c39-72ac-11ec-9cab-00e04ca2006b",
	"processInstanceId": "f07abe6c-72ac-11ec-9cab-00e04ca2006b",
	"masterData": {
		"leave_type": 1,
		"leave_begin_time": "2022-01-04",
		"leave_end_time": "2022-01-03",
		"leave_reason": "1111"
	},
	"flowTaskCommentDto": {
		"approvalType": "agree",
		"comment":"同意"
	}
}
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10010",
	"errorMessage":"该时间内已经存在申请，无法提交",
	"success":false
}
~~~

### 4. 部署流程

post  task/deployTask

入参

~~~
entryId（流程主键id）
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10012",
	"errorMessage":"流程图有误，无法部署",
	"success":false
}
~~~

### 5. 发布流程

post  task/publishTask

入参

~~~
processDefinitionKey（流程标识）
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10013",
	"errorMessage":"无权限，请联系管理员",
	"success":false
}
~~~

### 6. 查看审批记录

GET  task/queryTaskComment

入参

~~~
processInstanceId（流程实例Id） 
~~~

 出参：

| 字段名            | 名称         |
| :---------------- | ------------ |
| approvalType      | 审批类型     |
| createTime        | 创建时间     |
| createUserId      | 创建者Id     |
| createUsername    | 创建者显示名 |
| id                | 主键id       |
| processInstanceId | 流程实例Id   |
| taskId            | 任务Id       |
| taskKey           | 任务标识     |
| taskName          | 任务名称     |

示例：

~~~java
{
	"data":[
		{
			"approvalType":"agree",
			"createTime":"2022-01-10 17:28:16",
			"createUserId":1440965586715676672,
			"createUsername":"员工B",
			"id":1480471542218362880,
			"processInstanceId":"7ebb087e-71f7-11ec-9cab-00e04ca2006b",
			"taskId":"7ebb2fab-71f7-11ec-9cab-00e04ca2006b",
			"taskKey":"Activity_1tqx3ju",
			"taskName":"申请"
		}
	],
	"errorCode":"NO-ERROR",
	"errorMessage":"NO-MESSAGE",
	"success":true
}
~~~

### 7. 工单查询（分页）

GET  workOrder/queryWorkOrderList

入参

~~~
processDefinitionKey（流程标识名)  processInstanceId（流程实例ID（流水号））flowStatus(流程状态)  createTimeStart（创建开始时间） createTimeEnd（创建结束时间）
~~~

流程状态：已提交0，办理中1，未通过2，已完成3，已撤销4，已取消5

 出参：

| 字段名                | 名称                     |
| --------------------- | ------------------------ |
| workOrderId           | 主键Id                   |
| businessKey           | 业务主键值               |
| createTime            | 创建时间                 |
| createUserId          | 创建者Id                 |
| submitUsername        | 提交用户登录名称         |
| flowStatus            | 流程状态                 |
| masterData            | 业务主表数据             |
| onlineTableId         | 在线表单的主表Id         |
| processDefinitionId   | 流程引擎的定义Id         |
| processDefinitionKey  | 流程定义标识             |
| processDefinitionName | 流程名称                 |
| processInstanceId     | 流程实例ID               |
| runtimeTaskInfoList   | 当前实例的运行时任务列表 |

示例：

~~~java
{
	"data":{
		"dataList":[
			{
                "workOrderId":1481098638825361408,
				"businessKey":"1481098637101502464",
				"createTime":"2022-01-12 11:00:08",
				"createUserId":1440965465605148672,
                "submitUsername":"userA",
				"flowStatus":0,
				"masterData":{
					"leave_begin_time":"2022-01-01 00:00:00",
					"leave_type":3,
					"user_id":1440965465605148672,
					"user_id_DictMap":{
						"name":"员工A",
						"id":1440965465605148672
					},
					"apply_time":"2022-01-12 11:00:07",
					"leave_reason":"1111",
					"id":1481098637101502464,
					"leave_end_time":"2022-01-01 00:00:00"
				},
				"onlineTableId":1440945228079960064,
				"processDefinitionId":"flowLeave:9:7d23427c-69e6-11ec-bb85-0235bf949cb9",
				"processDefinitionKey":"flowLeave",
				"processDefinitionName":"请假申请",
				"processInstanceId":"bf6faf69-7353-11ec-9cab-00e04ca2006b",
				"runtimeTaskInfoList":[
					{
						"taskKey":"Activity_11jr0px",
						"taskName":"部门领导审批",
						"taskId":"bf88dcd3-7353-11ec-9cab-00e04ca2006b"
					}
				]
			}
		],
		"totalCount":1
	},
	"errorCode":"NO-ERROR",
	"errorMessage":"NO-MESSAGE",
	"success":true
}
~~~

### 8. 工单新建

POST  workOrder/addWorkOrder

入参

| 字段名               | 名称         |
| -------------------- | ------------ |
| processDefinitionKey | 流程定义标识 |
| masterData           | 业务表数据   |
| slaveData            | 多个从表数据 |

~~~
{
	"processDefinitionKey": "flowLeave",
	"masterData": {
		"leave_type": 3,
		"leave_begin_time": "2022-01-01",
		"leave_end_time": "2022-01-01",
		"leave_reason": "1111"
	}
}
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10013",
	"errorMessage":"无权限，请联系管理员",
	"success":false
}
~~~

### 9. 工单催办

POST  workOrder/urgeWorkOrder

入参

~~~
workOrderId（工单ID)
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10013",
	"errorMessage":"无权限，请联系管理员",
	"success":false
}
~~~

### 10. 工单撤销（只要审批中，都可以撤销。并且在已办中展示）

PUT  workOrder/revokeWorkOrder

入参

~~~
workOrderId（工单ID)
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10013",
	"errorMessage":"无权限，请联系管理员",
	"success":false
}
~~~

### 11. 工单删除（未经过其他节点审批）

DELETE  workOrder/deleteWorkOrder

入参

~~~
workOrderId（工单ID)
~~~

 出参：

~~~java
{
	"data":"",
	"errorCode":"",
	"errorMessage":"",
	"success":true
}

{
	"data":"",
	"errorCode":"10013",
	"errorMessage":"已经在审核中，无法删除",
	"success":false
}
~~~

### 12. 查看所有可申请的流程

GET business/queryAllBusinessType

入参

~~~
无
~~~

 出参：

~~~java
"data":[{
   "code":"flowLeave",
   "value":"请假申请"
   },
   {
   "code":"flowContract",
   "value":"合同申请"
   }
]
~~~

### 13.查询工单动态表头列

GET business/queryWorkOrderColumn

入参

~~~
workOrderType（工单类型）
~~~

 出参：

~~~java
"data":[{
   "code":"vocationType",
   "value":"请假类型"
   },
   {
   "code":"startTime",
   "value":"开始时间"
   }
]
~~~

### 15.查询流程动态表单

GET business/queryBusinessForm

入参

~~~
businessType（工单类型）
~~~

 出参：

~~~java

~~~

### 16.查询单条业务数据

GET business/queryBusinessData

入参

~~~
processInstanceId（流程ID）  taskId（任务ID）
~~~

 出参：

~~~java
{
	"data":{
		"masterAndOneToOne":{
			"leave_begin_time":"2022-01-01 00:00:00",
			"leave_type":3,
			"user_id":1440965586715676672,
			"user_id__DictMap":{
				"name":"员工B",
				"id":1440965586715676672
			},
			"apply_time":"2022-01-12 14:40:06",
			"leave_reason":"111",
			"id":1481153997724192768,
			"leave_end_time":"2022-01-01 00:00:00"
		}
	},
	"errorCode":"NO-ERROR",
	"errorMessage":"NO-MESSAGE",
	"success":true
}
~~~
